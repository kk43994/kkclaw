<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KKClaw Setup Wizard â€” Interactive Demo</title>
<style>
  :root {
    --wood-dark: #5a3a1a;
    --wood-medium: #8b6238;
    --wood-light: #b8905a;
    --parchment: #faebd7;
    --parchment-dark: #e8d5b0;
    --grass: #5c8a2f;
    --grass-light: #7cb342;
    --text-dark: #3d2610;
    --text-medium: #6d5030;
    --gold: #ffc107;
    --gold-dark: #f9a825;
    --red: #c0392b;
    --green: #27ae60;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  *::-webkit-scrollbar { width: 8px; }
  *::-webkit-scrollbar-track { background: var(--parchment-dark); }
  *::-webkit-scrollbar-thumb { background: linear-gradient(180deg, var(--wood-light), var(--wood-medium)); border-radius: 4px; }

  body {
    font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
    color: var(--text-dark);
    height: 100vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    background: #3a7d2a;
  }
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(circle at 20% 80%, #4a8d32 0%, transparent 40%),
      radial-gradient(circle at 80% 20%, #2d6b1a 0%, transparent 40%),
      linear-gradient(180deg, #5a9d3a 0%, #3a7d2a 30%, #2d6b1a 100%);
    pointer-events: none;
    z-index: 0;
  }
  body > * { position: relative; z-index: 1; }

  .wizard-header {
    padding: 10px 16px 6px;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0; position: relative;
    background: linear-gradient(180deg, var(--wood-dark) 0%, var(--wood-medium) 60%, var(--wood-light) 100%);
    border-bottom: 3px solid var(--wood-dark);
    box-shadow: 0 3px 0 0 rgba(0,0,0,0.2);
  }
  .wizard-header h1 {
    font-size: 16px; color: var(--gold); font-weight: 700;
    letter-spacing: 2px;
    text-shadow: 1px 1px 0 var(--wood-dark), 2px 2px 0 rgba(0,0,0,0.3);
    font-family: 'Courier New', monospace;
  }
  .demo-badge {
    position: absolute; right: 12px; top: 50%; transform: translateY(-50%);
    padding: 3px 10px; border: 2px solid var(--gold); border-radius: 2px;
    background: rgba(255,193,7,0.15); color: var(--gold);
    font-size: 11px; font-family: 'Courier New', monospace; font-weight: 700;
  }

  .progress-bar {
    display: flex; justify-content: center; gap: 6px;
    padding: 10px 12px 8px; flex-shrink: 0;
    background: linear-gradient(180deg, var(--wood-medium), var(--wood-light) 40%, var(--parchment-dark));
    border-bottom: 2px solid var(--wood-medium);
  }
  .progress-dot {
    width: 18px; height: 18px;
    background: var(--parchment-dark); border: 2px solid var(--wood-medium);
    transition: all 0.3s; cursor: pointer; position: relative;
    clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
  }
  .progress-dot.active {
    background: var(--gold); border-color: var(--gold-dark);
    transform: scale(1.3); filter: drop-shadow(0 0 4px rgba(255,193,7,0.6));
  }
  .progress-dot.done { background: var(--grass-light); border-color: var(--grass); }
  .progress-dot::after {
    content: attr(data-label);
    position: absolute; top: 22px; left: 50%; transform: translateX(-50%);
    font-size: 9px; color: var(--text-medium); white-space: nowrap;
    font-family: 'Courier New', monospace; font-weight: 600;
  }

  .chat-area {
    flex: 1; overflow-y: auto; padding: 12px 16px;
    display: flex; flex-direction: column; gap: 10px;
    background: var(--parchment);
    border-left: 4px solid var(--wood-medium);
    border-right: 4px solid var(--wood-medium);
    box-shadow: inset 0 0 20px rgba(90,58,26,0.08);
  }

  .bubble-row { display: flex; gap: 8px; align-items: flex-start; animation: fadeIn 0.3s ease; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

  .avatar {
    width: 34px; height: 34px; border-radius: 2px;
    background: linear-gradient(135deg, #e8b068, #d49040);
    display: flex; align-items: center; justify-content: center;
    font-size: 18px; flex-shrink: 0;
    border: 2px solid var(--wood-dark); box-shadow: 1px 1px 0 var(--wood-dark);
  }
  .bubble {
    background: #fffdf5; border: 2px solid var(--wood-medium); border-radius: 2px;
    padding: 8px 12px; max-width: 85%;
    box-shadow: 2px 2px 0 rgba(90,58,26,0.15);
    line-height: 1.6; font-size: 13px; color: var(--text-dark); position: relative;
  }
  .bubble::before {
    content: ''; position: absolute; left: -7px; top: 8px;
    border: 5px solid transparent; border-right-color: var(--wood-medium);
    border-left: 0; width: 0; height: 0;
  }
  .bubble::after {
    content: ''; position: absolute; left: -4px; top: 9px;
    border: 4px solid transparent; border-right-color: #fffdf5;
    border-left: 0; width: 0; height: 0;
  }
  .typing-cursor {
    display: inline-block; width: 2px; height: 13px;
    background: var(--wood-dark); animation: blink 0.5s step-end infinite;
    vertical-align: middle; margin-left: 1px;
  }
  @keyframes blink { 50% { opacity: 0; } }

  .card {
    background: #fffdf5; border: 2px solid var(--wood-medium); border-radius: 2px;
    padding: 12px 14px; margin: 4px 0;
    box-shadow: 2px 2px 0 rgba(90,58,26,0.15); animation: fadeIn 0.3s ease;
  }
  .card h3 { font-size: 13px; color: var(--wood-dark); margin-bottom: 10px; font-weight: 700; }

  .status-item { display: flex; align-items: center; gap: 8px; padding: 6px 0; }
  .status-icon {
    width: 22px; height: 22px; border-radius: 2px;
    display: flex; align-items: center; justify-content: center;
    font-size: 12px; font-weight: 700; flex-shrink: 0;
  }
  .status-icon.loading { background: var(--parchment-dark); border: 2px solid var(--wood-light); animation: pulse 1s infinite; }
  .status-icon.success { background: var(--grass-light); border: 2px solid var(--grass); color: #fff; }
  .status-icon.fail { background: var(--red); border: 2px solid #a93226; color: #fff; }
  @keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.5; } }

  .engine-list, .engine-grid { display: flex; flex-direction: column; gap: 6px; }
  .provider-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
  .engine-card {
    padding: 8px 12px; border: 2px solid var(--parchment-dark); border-radius: 2px;
    background: var(--parchment); cursor: pointer; transition: all 0.2s; position: relative;
  }
  .engine-card:hover { border-color: var(--wood-light); background: #fffdf5; }
  .engine-card.selected { border-color: var(--gold); background: #fff8e1; box-shadow: 0 0 0 1px var(--gold); }
  .engine-card .engine-name { font-size: 12px; font-weight: 700; color: var(--text-dark); }
  .engine-card .engine-desc { font-size: 10px; color: var(--text-medium); margin-top: 2px; }
  .engine-badge {
    position: absolute; top: 6px; right: 8px;
    font-size: 9px; padding: 1px 6px; border-radius: 2px; font-weight: 700;
  }
  .engine-badge.recommend { background: #e8f5e9; color: var(--grass); border: 1px solid var(--grass-light); }
  .engine-badge.best { background: #fff3e0; color: #e65100; border: 1px solid #ffb74d; }
  .engine-badge.free { background: #e3f2fd; color: #1565c0; border: 1px solid #64b5f6; }
  .provider-grid .engine-card.full-width { grid-column: 1 / -1; }

  .form-group { margin-bottom: 10px; }
  .form-group label { display: block; font-size: 11px; font-weight: 600; color: var(--text-medium); margin-bottom: 4px; }
  .form-input {
    width: 100%; padding: 6px 10px; border: 2px solid var(--parchment-dark);
    border-radius: 2px; background: #fffdf5; font-size: 12px; color: var(--text-dark);
    font-family: inherit; transition: border-color 0.2s;
  }
  .form-input:focus { outline: none; border-color: var(--gold); }
  select.form-input { cursor: pointer; }

  .input-wrap { display: flex; gap: 4px; }
  .input-wrap .form-input { flex: 1; }
  .eye-btn {
    padding: 4px 8px; border: 2px solid var(--parchment-dark); border-radius: 2px;
    background: var(--parchment); cursor: pointer; font-size: 14px;
  }

  .toggle-row {
    display: flex; justify-content: space-between; align-items: center;
    padding: 8px 0; border-bottom: 1px solid var(--parchment-dark);
  }
  .toggle-row:last-child { border-bottom: none; }
  .toggle-label { font-size: 12px; font-weight: 600; display: flex; gap: 6px; align-items: center; }
  .toggle-sublabel { font-size: 10px; color: var(--text-medium); }
  .toggle-controls { display: flex; align-items: center; gap: 6px; }
  .toggle-tag { font-size: 10px; color: var(--text-medium); }

  .switch { position: relative; display: inline-block; width: 36px; height: 20px; }
  .switch input { opacity: 0; width: 0; height: 0; }
  .slider {
    position: absolute; cursor: pointer; inset: 0;
    background: var(--parchment-dark); border: 2px solid var(--wood-light);
    border-radius: 2px; transition: 0.3s;
  }
  .slider::before {
    content: ''; position: absolute; height: 12px; width: 12px;
    left: 2px; bottom: 2px; background: var(--wood-light);
    border-radius: 1px; transition: 0.3s;
  }
  input:checked + .slider { background: var(--grass-light); border-color: var(--grass); }
  input:checked + .slider::before { transform: translateX(16px); background: #fff; }

  .btn-row { display: flex; gap: 8px; margin-top: 8px; }
  .btn {
    padding: 6px 16px; border: 2px solid; border-radius: 2px;
    font-size: 12px; font-weight: 700; cursor: pointer;
    font-family: 'Courier New', monospace; transition: all 0.2s;
  }
  .btn-primary { background: var(--gold); border-color: var(--gold-dark); color: var(--wood-dark); }
  .btn-primary:hover { background: var(--gold-dark); }
  .btn-test { background: var(--parchment); border-color: var(--wood-light); color: var(--text-dark); }
  .btn-test:hover { border-color: var(--wood-medium); }
  .btn-small { padding: 4px 12px; font-size: 11px; }

  .note-box {
    padding: 8px 10px; border: 2px solid var(--parchment-dark); border-radius: 2px;
    background: rgba(255,253,240,0.6); font-size: 11px; color: var(--text-medium);
    line-height: 1.5; margin-bottom: 10px;
  }

  .upload-area {
    border: 2px dashed var(--wood-light); border-radius: 2px;
    padding: 16px; text-align: center; cursor: pointer; transition: all 0.2s;
    background: rgba(255,253,240,0.4);
  }
  .upload-area:hover { border-color: var(--gold); background: rgba(255,248,225,0.4); }
  .upload-icon { font-size: 24px; margin-bottom: 4px; }
  .upload-text { font-size: 12px; color: var(--text-dark); font-weight: 600; }
  .upload-hint { font-size: 10px; color: var(--text-medium); margin-top: 2px; }

  .test-list { display: flex; flex-direction: column; gap: 6px; }
  .test-item { display: flex; align-items: center; gap: 8px; padding: 6px 8px; border-radius: 2px; background: var(--parchment); }
  .test-name { font-size: 12px; font-weight: 600; flex: 1; }
  .test-msg { font-size: 11px; color: var(--text-medium); }

  .wizard-footer {
    padding: 8px 16px; display: flex; justify-content: space-between; align-items: center;
    flex-shrink: 0;
    background: linear-gradient(180deg, var(--parchment-dark), var(--wood-light) 60%, var(--wood-medium));
    border-top: 2px solid var(--wood-medium);
  }
  .btn-secondary { background: var(--parchment); border-color: var(--wood-light); color: var(--text-dark); }
  .btn-secondary:hover { border-color: var(--wood-medium); }
  .step-label { font-size: 11px; color: var(--text-medium); font-family: 'Courier New', monospace; }

  .env-check { font-size: 11px; padding: 6px 8px; border-radius: 2px; margin-top: 8px; }
  .env-check.ok { background: #e8f5e9; color: var(--grass); }

  .feature-desc {
    background: linear-gradient(135deg, rgba(255,193,7,0.08), rgba(139,98,56,0.05));
    border: 2px solid var(--gold); border-radius: 2px;
    padding: 10px 14px; margin: 6px 0; font-size: 12px; line-height: 1.7;
    color: var(--text-dark);
  }
  .feature-desc strong { color: var(--wood-dark); }
  .feature-desc .tag {
    display: inline-block; padding: 1px 6px; border-radius: 2px;
    font-size: 10px; font-weight: 700; margin-right: 4px;
  }
  .feature-desc .tag-new { background: #e8f5e9; color: var(--grass); }
  .feature-desc .tag-core { background: #fff3e0; color: #e65100; }

  .hidden { display: none !important; }

  /* Celebration */
  .celebration {
    position: fixed; inset: 0; z-index: 999;
    display: flex; align-items: center; justify-content: center;
    background: rgba(0,0,0,0.6); backdrop-filter: blur(4px);
  }
  .celebration-content {
    background: var(--parchment); border: 4px solid var(--gold);
    border-radius: 4px; padding: 32px 40px; text-align: center;
    box-shadow: 0 0 40px rgba(255,193,7,0.3);
    animation: celebPop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
  }
  @keyframes celebPop { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
  .celebration h2 { font-size: 20px; color: var(--gold-dark); margin-bottom: 8px; }
  .celebration p { font-size: 13px; color: var(--text-medium); line-height: 1.6; }
  .celebration .btn { margin-top: 16px; }
</style>
</head>
<body>

<div class="wizard-header">
  <h1>KKClaw Setup Wizard</h1>
  <span class="demo-badge">DEMO</span>
</div>

<div class="progress-bar" id="progressBar"></div>

<div class="chat-area" id="chatArea"></div>

<div class="wizard-footer">
  <button class="btn btn-secondary" id="btnPrev" onclick="prevStep()" style="visibility:hidden">ä¸Šä¸€æ­¥</button>
  <span class="step-label" id="stepLabel">Step 1/7</span>
  <button class="btn btn-primary" id="btnNext" onclick="nextStep()">ä¸‹ä¸€æ­¥</button>
</div>

<div class="celebration hidden" id="celebration"></div>

<script>
let currentStep = 0;
const totalSteps = 7;
const stepLabels = ['Gateway','Model','Channels','TTS','Voice','Display','Done'];

// Step feature descriptions shown alongside the UI
const stepFeatures = [
  { tags: ['core'], title: 'Gateway è‡ªåŠ¨æ£€æµ‹',
    desc: 'è‡ªåŠ¨æ‰«ææœ¬åœ° OpenClaw Gateway è¿æ¥çŠ¶æ€ï¼Œæ£€æµ‹ç«¯å£å’Œ Tokenã€‚è¿æ¥å¤±è´¥æ—¶æä¾›æ‰‹åŠ¨è¾“å…¥å…¥å£ï¼Œæ”¯æŒä¸€é”®æµ‹è¯•ã€‚' },
  { tags: ['core'], title: 'å¤šæ¨¡å‹ä¸€é”®é…ç½®',
    desc: 'å†…ç½® 9 å¤§ AI æœåŠ¡å•†é¢„è®¾ï¼ˆAnthropic / OpenAI / Google / DeepSeek / OpenRouter / æ™ºè°± / é€šä¹‰ / Kimi / MiniMaxï¼‰ï¼Œæ”¯æŒè‡ªå®šä¹‰ä¸­è½¬ç«™ã€‚é€‰æ‹©å³é…ç½®ï¼ŒAPI Key åŠ å¯†å­˜å‚¨ã€‚' },
  { tags: ['new'], title: 'æ¸ é“ç‹¬ç«‹æ§åˆ¶',
    desc: 'é£ä¹¦ã€Telegramã€Discordã€Webã€ä¼ä¸šå¾®ä¿¡ â€” æ¯ä¸ªæ¸ é“ç‹¬ç«‹å¼€å…³è¯­éŸ³æ’­æŠ¥å’Œæ¡Œé¢æ­Œè¯ã€‚ä¸€ä¸ªå® ç‰©ï¼Œå¤šå¹³å°è”åŠ¨ã€‚' },
  { tags: ['new'], title: 'è¯­éŸ³å¼•æ“ + éŸ³è‰²å…‹éš†',
    desc: '4 ç§ TTS å¼•æ“å¯é€‰ï¼šMiniMax 2.8 HDï¼ˆæœ€ä½³éŸ³è´¨ï¼‰ã€MiniMax 2.5 Turboï¼ˆæ¨èï¼‰ã€CosyVoiceï¼ˆé˜¿é‡Œäº‘ï¼‰ã€Edge TTSï¼ˆå…è´¹ï¼‰ã€‚æ”¯æŒä¸Šä¼ å½•éŸ³ä¸€é”®å…‹éš†ä¸“å±éŸ³è‰²ã€‚' },
  { tags: ['new'], title: 'Agent äººè®¾å®šåˆ¶',
    desc: 'ç»™ä½ çš„ AI ä¼™ä¼´èµ·åå­—ã€é€‰è¯´è¯é£æ ¼ï¼ˆç”œå¦¹ / ä¸“ä¸š / å¹½é»˜ / é…·å¸… / è‡ªå®šä¹‰ï¼‰ã€‚è‡ªåŠ¨ç”Ÿæˆ AGENTS.md + SOUL.md + USER.md + HEARTBEAT.md å…¨å¥—é…ç½®ã€‚' },
  { tags: ['core'], title: 'æ˜¾ç¤ºåå¥½è®¾ç½®',
    desc: 'æ¡Œé¢æ­Œè¯å¼€å…³ã€çƒä½“ç½®é¡¶ã€å¼€æœºè‡ªå¯åŠ¨ â€” ä¸‰ä¸ªå¼€å…³æå®šæ¡Œé¢æ˜¾ç¤ºåå¥½ã€‚' },
  { tags: ['core'], title: 'å…¨é“¾è·¯è‡ªåŠ¨æµ‹è¯•',
    desc: '7 é¡¹è‡ªåŠ¨åŒ–æµ‹è¯•ï¼šGateway â†’ æ¨¡å‹ â†’ TTS â†’ æ’­æŠ¥ â†’ æ­Œè¯ â†’ Agent é…ç½® â†’ è‡ªå®šä¹‰éŸ³è‰²ã€‚é€é¡¹æ£€æµ‹ï¼Œå¤±è´¥å¯å•ç‹¬é‡è¯•ã€‚' },
];

function initProgressBar() {
  const bar = document.getElementById('progressBar');
  bar.innerHTML = stepLabels.map((l, i) =>
    `<div class="progress-dot ${i === 0 ? 'active' : ''}" data-step="${i}" data-label="${l}" onclick="jumpToStep(${i})"></div>`
  ).join('');
}

function updateProgress() {
  document.querySelectorAll('.progress-dot').forEach((dot, i) => {
    dot.className = 'progress-dot' + (i === currentStep ? ' active' : i < currentStep ? ' done' : '');
  });
  document.getElementById('stepLabel').textContent = `Step ${currentStep + 1}/${totalSteps}`;
  document.getElementById('btnPrev').style.visibility = currentStep > 0 ? 'visible' : 'hidden';
  document.getElementById('btnNext').textContent = currentStep === totalSteps - 1 ? 'å®Œæˆ ğŸ‰' : 'ä¸‹ä¸€æ­¥';
}

function escapeHtml(s) { const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }

function typewrite(el, text, speed = 25) {
  return new Promise(resolve => {
    el.innerHTML = '';
    const cursor = document.createElement('span');
    cursor.className = 'typing-cursor';
    el.appendChild(cursor);
    let i = 0;
    const iv = setInterval(() => {
      if (i < text.length) {
        el.insertBefore(document.createTextNode(text[i]), cursor);
        i++;
        document.getElementById('chatArea').scrollTop = 999999;
      } else { clearInterval(iv); cursor.remove(); resolve(); }
    }, speed);
  });
}

async function addBubble(text) {
  const chat = document.getElementById('chatArea');
  const row = document.createElement('div');
  row.className = 'bubble-row';
  row.innerHTML = `<div class="avatar">ğŸ¦</div><div class="bubble"></div>`;
  chat.appendChild(row);
  await typewrite(row.querySelector('.bubble'), text);
}

function addCard(html) {
  const chat = document.getElementById('chatArea');
  const card = document.createElement('div');
  card.className = 'card';
  card.innerHTML = html;
  chat.appendChild(card);
  chat.scrollTop = 999999;
  return card;
}

function addFeatureDesc(stepIdx) {
  const f = stepFeatures[stepIdx];
  if (!f) return;
  const tagHtml = f.tags.map(t => `<span class="tag tag-${t}">${t === 'new' ? 'v3.0 NEW' : 'CORE'}</span>`).join('');
  const chat = document.getElementById('chatArea');
  const el = document.createElement('div');
  el.className = 'feature-desc';
  el.innerHTML = `${tagHtml}<strong>${f.title}</strong><br>${f.desc}`;
  chat.appendChild(el);
  chat.scrollTop = 999999;
}

// â”€â”€â”€ Step Renderers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function renderStep(step) {
  document.getElementById('chatArea').innerHTML = '';
  addFeatureDesc(step);
  switch(step) {
    case 0: await renderGateway(); break;
    case 1: await renderModel(); break;
    case 2: await renderChannels(); break;
    case 3: await renderTTS(); break;
    case 4: await renderVoice(); break;
    case 5: await renderDisplay(); break;
    case 6: await renderTest(); break;
  }
}

async function renderGateway() {
  await addBubble('ä½ å¥½å‘€~ æˆ‘æ˜¯å°Kï¼(^_^) æ¬¢è¿ä½¿ç”¨ KKClaw æ¡Œé¢å® ç‰©~');
  await addBubble('è®©æˆ‘å…ˆå¸®ä½ æ£€æŸ¥ä¸€ä¸‹ OpenClaw Gateway çš„è¿æ¥çŠ¶æ€å§ï¼');
  addCard(`
    <h3>OpenClaw Gateway æ£€æµ‹</h3>
    <div class="status-item">
      <div class="status-icon loading" id="gw-icon"></div>
      <span id="gw-text">æ­£åœ¨æ£€æµ‹ Gateway...</span>
    </div>
  `);
  // Simulate detection
  await new Promise(r => setTimeout(r, 1200));
  document.getElementById('gw-icon').className = 'status-icon success';
  document.getElementById('gw-icon').textContent = 'âœ“';
  document.getElementById('gw-text').textContent = 'Gateway è¿æ¥æˆåŠŸ (ç«¯å£ 18789)';
  await addBubble('æ‰¾åˆ°å•¦ï¼è¿æ¥æˆåŠŸï¼âœ§*ã€‚(o^_^o)âœ§*ã€‚');
}

async function renderModel() {
  await addBubble('æ¥ä¸‹æ¥é…ç½®ä½ çš„ AI æ¨¡å‹å§~ (^_^)');
  const providers = [
    { key:'anthropic', name:'Anthropic', desc:'Claude Opus 4 / Sonnet 4', badge:'recommend', badgeText:'æ¨è' },
    { key:'openai', name:'OpenAI', desc:'GPT-4o / o3 / o4-mini' },
    { key:'google', name:'Google AI', desc:'Gemini 2.5 Pro / 2.0 Flash' },
    { key:'deepseek', name:'DeepSeek', desc:'DeepSeek V3 / R1' },
    { key:'openrouter', name:'OpenRouter', desc:'å¤šæ¨¡å‹ä¸­è½¬' },
    { key:'zhipu', name:'æ™ºè°± GLM', desc:'GLM-4 Plus' },
    { key:'qwen', name:'é€šä¹‰åƒé—®', desc:'Qwen Max / Turbo' },
    { key:'kimi', name:'Kimi', desc:'Kimi K2' },
    { key:'minimax', name:'MiniMax', desc:'MiniMax M1' },
  ];
  let cards = providers.map(p => {
    const badge = p.badge ? `<span class="engine-badge ${p.badge}">${p.badgeText}</span>` : '';
    return `<div class="engine-card" onclick="this.parentElement.querySelectorAll('.engine-card').forEach(c=>c.classList.remove('selected'));this.classList.add('selected');document.getElementById('model-cfg').classList.remove('hidden')">
      <div class="engine-name">${p.name}</div><div class="engine-desc">${p.desc}</div>${badge}
    </div>`;
  }).join('');
  cards += `<div class="engine-card full-width" onclick="this.parentElement.querySelectorAll('.engine-card').forEach(c=>c.classList.remove('selected'));this.classList.add('selected')">
    <div class="engine-name">è‡ªå®šä¹‰ä¸­è½¬ç«™</div><div class="engine-desc">æ”¯æŒä»»æ„å…¼å®¹ OpenAI / Anthropic åè®®çš„æœåŠ¡</div>
  </div>`;

  addCard(`
    <h3>AI æ¨¡å‹é…ç½®</h3>
    <div class="provider-grid">${cards}</div>
    <div id="model-cfg" class="hidden" style="margin-top:12px">
      <div class="form-group"><label>æ¨¡å‹é€‰æ‹©</label>
        <select class="form-input"><option>Claude Opus 4</option><option>Claude Sonnet 4</option><option>Claude Haiku 3.5</option></select>
      </div>
      <div class="form-group"><label>API Key</label>
        <div class="input-wrap"><input type="password" class="form-input" placeholder="è¾“å…¥ API Key"><button class="eye-btn">ğŸ‘</button></div>
      </div>
      <div class="btn-row"><button class="btn btn-test" onclick="this.textContent='âœ“ é…ç½®æœ‰æ•ˆ';this.style.color='var(--grass)'">æµ‹è¯•é…ç½®</button></div>
    </div>
  `);
}

async function renderChannels() {
  await addBubble('æ¥ä¸‹æ¥é…ç½®ä½ çš„æ¶ˆæ¯æ¸ é“å§~ (^_^)');
  const channels = [
    { icon:'ğŸ¦', name:'é£ä¹¦ Feishu', v:true, l:true },
    { icon:'âœˆï¸', name:'Telegram', v:true, l:true },
    { icon:'ğŸ’¬', name:'Discord', v:false, l:true },
    { icon:'ğŸŒ', name:'Web', v:false, l:false },
    { icon:'ğŸ’¼', name:'ä¼ä¸šå¾®ä¿¡ WeCom', v:true, l:true },
  ];
  const rows = channels.map(c => `
    <div class="toggle-row">
      <div class="toggle-label"><span>${c.icon}</span><span>${c.name}</span></div>
      <div class="toggle-controls">
        <span class="toggle-tag">Voice</span>
        <label class="switch"><input type="checkbox" ${c.v?'checked':''}><span class="slider"></span></label>
        <span class="toggle-tag">Lyrics</span>
        <label class="switch"><input type="checkbox" ${c.l?'checked':''}><span class="slider"></span></label>
      </div>
    </div>
  `).join('');
  addCard(`<h3>æ¶ˆæ¯æ¸ é“é…ç½®</h3>${rows}`);
}

async function renderTTS() {
  await addBubble('ç°åœ¨æ¥é€‰æ‹©ä½ çš„è¯­éŸ³å¼•æ“å§~ (*^_^*)');
  const engines = [
    { id:'hd', name:'MiniMax Speech 2.8 HD', desc:'æœ€ä½³éŸ³è´¨ï¼Œæƒ…æ„Ÿä¸°å¯Œ', badge:'best', badgeText:'æœ€ä½³éŸ³è´¨' },
    { id:'turbo', name:'MiniMax Speech 2.5 Turbo', desc:'æ€§ä»·æ¯”é«˜ï¼Œé€Ÿåº¦å¿«', badge:'recommend', badgeText:'æ¨è', sel:true },
    { id:'cosy', name:'CosyVoice (é˜¿é‡Œäº‘)', desc:'é˜¿é‡Œäº‘è¯­éŸ³åˆæˆ' },
    { id:'edge', name:'Edge TTS', desc:'å…è´¹ã€æ— éœ€é…ç½®', badge:'free', badgeText:'å…è´¹' },
  ];
  const list = engines.map(e => {
    const badge = e.badge ? `<span class="engine-badge ${e.badge}">${e.badgeText}</span>` : '';
    return `<div class="engine-card ${e.sel?'selected':''}" onclick="this.parentElement.querySelectorAll('.engine-card').forEach(c=>c.classList.remove('selected'));this.classList.add('selected')">
      <div class="engine-name">${e.name}</div><div class="engine-desc">${e.desc}</div>${badge}
    </div>`;
  }).join('');

  addCard(`
    <h3>TTS è¯­éŸ³å¼•æ“é€‰æ‹©</h3>
    <div class="engine-list">${list}</div>
    <div class="env-check ok" style="margin-top:8px">âœ“ Python 3.11 + edge-tts (æ‰€æœ‰å¼•æ“å¯ç”¨)</div>
    <div style="margin-top:12px">
      <div class="form-group"><label>API Key</label>
        <div class="input-wrap"><input type="password" class="form-input" placeholder="è¾“å…¥ MiniMax API Key"><button class="eye-btn">ğŸ‘</button></div>
      </div>
    </div>
    <div style="margin-top:14px;border-top:2px dashed var(--parchment-dark);padding-top:12px">
      <h3 style="font-size:12px;margin-bottom:8px">ğŸ¤ è‡ªå®šä¹‰éŸ³è‰²ï¼ˆå¯é€‰ï¼‰</h3>
      <div class="note-box">ğŸ’¡ ä¸Šä¼ 30ç§’ä»¥ä¸Šçš„æ¸…æ™°å½•éŸ³ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å…‹éš†ä½ çš„ä¸“å±éŸ³è‰²ã€‚</div>
      <div class="upload-area"><div class="upload-icon">ğŸ™ï¸</div><div class="upload-text">ç‚¹å‡»é€‰æ‹©æˆ–æ‹–æ‹½éŸ³é¢‘æ–‡ä»¶</div><div class="upload-hint">æ”¯æŒ MP3ã€WAVã€M4A</div></div>
    </div>
    <div class="btn-row" style="margin-top:12px"><button class="btn btn-test" onclick="this.textContent='ğŸ”Š æ’­æ”¾ä¸­...';setTimeout(()=>this.textContent='è¯•å¬ä¸€ä¸‹',1500)">è¯•å¬ä¸€ä¸‹</button></div>
  `);
}

async function renderVoice() {
  await addBubble('ç°åœ¨æ¥é…ç½® Agent è¯­éŸ³æ’­æŠ¥å§ï¼(^_^)');
  addCard(`
    <h3>Agent è¯­éŸ³æ’­æŠ¥é…ç½®</h3>
    <div class="form-group"><label>OpenClaw å·¥ä½œç›®å½•</label>
      <input type="text" class="form-input" value="~/.openclaw/" placeholder="~/.openclaw/">
    </div>
    <div style="border-top:2px dashed var(--parchment-dark);padding-top:12px;margin-top:12px">
      <h3 style="font-size:12px;margin-bottom:8px">ğŸ­ Agent äººè®¾å®šåˆ¶</h3>
      <div class="note-box">ğŸ’¡ å®šä¹‰ä½ çš„ Agent è¯´è¯é£æ ¼ã€‚äººè®¾å¯ä»¥å’Œåˆ«äººä¸ä¸€æ ·ï¼Œåšä½ è‡ªå·±çš„ AI ä¼™ä¼´ï¼</div>
      <div class="form-group"><label>å® ç‰©æ˜µç§°</label><input type="text" class="form-input" placeholder="ä¾‹å¦‚ï¼šå°Kã€å°åŠ©æ‰‹ã€Claw"></div>
      <div class="form-group"><label>ä½ çš„ç§°å‘¼</label><input type="text" class="form-input" placeholder="ä¾‹å¦‚ï¼šä¸»äººã€Bossã€KK"></div>
      <div class="form-group"><label>è¯´è¯é£æ ¼</label>
        <select class="form-input">
          <option>ç”œå¦¹é£æ ¼ â€” æ¸©æŸ”å¯çˆ±ï¼Œå¶å°”æ’’å¨‡</option>
          <option>ä¸“ä¸šåŠ©æ‰‹ â€” é«˜æ•ˆä¸¥è°¨ï¼Œæ¡ç†æ¸…æ™°</option>
          <option>å¹½é»˜ææ€ª â€” çˆ±å¼€ç©ç¬‘ï¼Œè½»æ¾æ´»æ³¼</option>
          <option>é…·å¸…é£æ ¼ â€” ç®€æ´åˆ©è½ï¼Œä¸åºŸè¯</option>
          <option>è‡ªå®šä¹‰...</option>
        </select>
      </div>
    </div>
    <div class="note-box" style="margin-top:12px">ğŸ’¡ <strong>æ¨¡å‹å…¼å®¹æ€§ï¼š</strong>Claude Sonnet 4 åŠä»¥ä¸Šæ——èˆ°æ¨¡å‹æ•ˆæœæœ€ä½³ã€‚è½»é‡æ¨¡å‹å¯èƒ½å¶å°”é—æ¼æ’­æŠ¥ã€‚</div>
    <div class="btn-row"><button class="btn btn-primary btn-small" onclick="this.textContent='âœ“ å·²é…ç½®';this.style.background='var(--grass-light)'">é…ç½®æ’­æŠ¥</button><button class="btn btn-test">æµ‹è¯•æ’­æŠ¥</button></div>
  `);
}

async function renderDisplay() {
  await addBubble('å¿«è¦å®Œæˆå•¦ï¼æ¥è®¾ç½®ä¸€ä¸‹æ˜¾ç¤ºé€‰é¡¹å§~ (^_^)');
  addCard(`
    <h3>æ¡Œé¢æ˜¾ç¤ºè®¾ç½®</h3>
    <div class="toggle-row"><div><div class="toggle-label">æ¡Œé¢æ­Œè¯</div><div class="toggle-sublabel">åœ¨å® ç‰©ä¸Šæ–¹æ˜¾ç¤ºæ¶ˆæ¯å­—å¹•</div></div>
      <label class="switch"><input type="checkbox" checked><span class="slider"></span></label></div>
    <div class="toggle-row"><div><div class="toggle-label">çƒä½“ç½®é¡¶</div><div class="toggle-sublabel">å® ç‰©å§‹ç»ˆæ˜¾ç¤ºåœ¨æœ€ä¸Šå±‚</div></div>
      <label class="switch"><input type="checkbox" checked><span class="slider"></span></label></div>
    <div class="toggle-row"><div><div class="toggle-label">å¼€æœºè‡ªå¯åŠ¨</div><div class="toggle-sublabel">ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œ</div></div>
      <label class="switch"><input type="checkbox"><span class="slider"></span></label></div>
  `);
}

async function renderTest() {
  await addBubble('æœ€åä¸€æ­¥ï¼æ¥åšä¸€ä¸ªå…¨é“¾è·¯æµ‹è¯•å§~ (*^_^*)');
  const tests = [
    { id:'gw', name:'Gateway è¿æ¥' },
    { id:'model', name:'AI æ¨¡å‹é…ç½®' },
    { id:'tts', name:'TTS è¯­éŸ³å¼•æ“' },
    { id:'voice', name:'è¯­éŸ³æ’­æŠ¥é“¾è·¯' },
    { id:'lyrics', name:'æ¡Œé¢æ­Œè¯' },
    { id:'agent', name:'Agent é…ç½®æ–‡ä»¶' },
    { id:'clone', name:'è‡ªå®šä¹‰éŸ³è‰²' },
  ];
  const items = tests.map(t => `
    <div class="test-item"><div class="status-icon loading" id="t-${t.id}-icon"></div>
      <span class="test-name">${t.name}</span><span class="test-msg" id="t-${t.id}-msg">ç­‰å¾…ä¸­...</span></div>
  `).join('');
  addCard(`<h3>å…¨é“¾è·¯æµ‹è¯•</h3><div class="test-list">${items}</div>`);

  // Simulate sequential tests
  for (const t of tests) {
    document.getElementById(`t-${t.id}-msg`).textContent = 'æµ‹è¯•ä¸­...';
    await new Promise(r => setTimeout(r, 600));
    document.getElementById(`t-${t.id}-icon`).className = 'status-icon success';
    document.getElementById(`t-${t.id}-icon`).textContent = 'âœ“';
    document.getElementById(`t-${t.id}-msg`).textContent = 'é€šè¿‡';
    document.getElementById(`t-${t.id}-msg`).style.color = 'var(--grass)';
  }
  await addBubble('å…¨éƒ¨é€šè¿‡ï¼ä½ çš„ KKClaw å·²ç»å‡†å¤‡å°±ç»ªå•¦ï¼âœ§*ã€‚ãƒ¾(ï½¡>ï¹<ï½¡)ï¾‰ï¾âœ§*ã€‚');
}

// â”€â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function nextStep() {
  if (currentStep === totalSteps - 1) {
    showCelebration();
    return;
  }
  currentStep++;
  updateProgress();
  renderStep(currentStep);
}

function prevStep() {
  if (currentStep > 0) { currentStep--; updateProgress(); renderStep(currentStep); }
}

function jumpToStep(step) {
  currentStep = step;
  updateProgress();
  renderStep(currentStep);
}

function showCelebration() {
  const el = document.getElementById('celebration');
  el.classList.remove('hidden');
  el.innerHTML = `<div class="celebration-content">
    <h2>ğŸ‰ é…ç½®å®Œæˆï¼</h2>
    <p>ä½ çš„ KKClaw æ¡Œé¢å® ç‰©å·²ç»å‡†å¤‡å°±ç»ªï¼<br>äº«å—ä½ çš„ AI æ¡Œé¢ä¼´ä¾£å§~ âœ§*ã€‚(o^_^o)âœ§*ã€‚</p>
    <a href="https://github.com/kk43994/kkclaw/releases" target="_blank" class="btn btn-primary" style="display:inline-block;text-decoration:none;margin-top:16px">ä¸‹è½½ KKClaw</a>
  </div>`;
}

// â”€â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
initProgressBar();
updateProgress();
renderStep(0);
</script>
</body>
</html>
